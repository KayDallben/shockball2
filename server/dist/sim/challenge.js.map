{"version":3,"sources":["../../src/sim/challenge.js"],"names":["chance","Chance","Challenge","record","world","pitch","board","ball","leftPlayers","rightPlayers","tackleBall","playerTryRun","playerTryScore","playerTryPass","playerTryTackle","objects","length","resolveTackleBall","resolvePlayerRun","resolvePlayerTryScore","resolvePlayerTryPass","player","push","map","tackleScore","toughness","rpg","sum","highestTackleScore","Math","max","apply","winningPlayer","find","add","gameTime","goalProximity","possess","shockballPlayerUid","lastSideTouched","homeGoalSide","lastPlayerTouched","theBall","runningPlayer","possessedBy","randomTackler","pickone","tacklerScore","vision","runningPlayerScore","runForward","getsTackled","shootingPlayer","attackingSide","probability","random","opposingPlayer","undefined","role","shootingScore","throwing","blockingScore","blocking","score","goalBlock","slice","passingPlayer","passingScore","passing","passForward","passBlock","opposingActorUid","opposingActorName","name","addToScoreBoard","gameStateReset","reset","state","addScore","lastGoalSide","abs","goalPit","left","right","availableTeammates","filter","playerToWinPossession"],"mappings":"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","file":"challenge.js","sourcesContent":["import Chance from 'chance'\nconst chance = new Chance()\n\nexport default class Challenge {\n  constructor(record) {\n    this.world = null\n    this.pitch = null\n    this.board = null\n    this.ball = null\n    this.leftPlayers = null\n    this.rightPlayers = null\n    this.tackleBall = []\n    this.playerTryRun = []\n    this.playerTryScore = []\n    this.playerTryPass = []\n    this.playerTryTackle = []\n    this.record = record\n  }\n\n  update(world) {\n    this.world = world\n    this.pitch = this.world.objects[0]\n    this.board = this.world.objects[1]\n    this.ball = this.world.objects[2]\n    this.leftPlayers = this.world.leftPlayers\n    this.rightPlayers = this.world.rightPlayers\n    if (this.tackleBall.length > 0) {\n      this.resolveTackleBall()\n    }\n    if (this.playerTryRun.length > 0) {\n      this.resolvePlayerRun()\n    }\n    if (this.playerTryScore.length > 0) {\n      this.resolvePlayerTryScore()\n    }\n    if (this.playerTryPass.length > 0) {\n      this.resolvePlayerTryPass()\n    }\n  }\n\n  reset() {\n    this.tackleBall = []\n    this.playerTryRun =[]\n    this.playerTryScore = []\n    this.playerTryPass = []\n    this.playerTryTackle = []\n  }\n\n  addTackleBall(player) {\n    this.tackleBall.push(player)\n  }\n\n  addTryRun(player) {\n    this.playerTryRun.push(player)\n  }\n\n  addTryScore(player) {\n    this.playerTryScore.push(player)\n  }\n\n  addTryPass(player) {\n    this.playerTryPass.push(player)\n  }\n\n  addTryTacklePlayer(player) {\n    this.playerTryTackle.push(player)\n  }\n\n  resolveTackleBall() {\n    // here would be a struggle between whoever else on the field for control of the ball, or shot block, or pass interception/block, after winning the encounter, .possess is called\n    // for now the Toughness attribute determines who wins the Tackle\n    // for now we look at each player vying to tackle the ball, and add their Toughness and a random dice roll - highest wins\n    this.tackleBall.map(function(player){\n      player.tackleScore = player.toughness + chance.rpg('2d6', {sum:true})\n    })\n    const highestTackleScore = Math.max.apply(Math, this.tackleBall.map(function(player) {\n      return player.tackleScore\n    }))\n    const winningPlayer = this.tackleBall.find(function(player) {\n      return player.tackleScore === highestTackleScore\n    })\n    this.record.add(winningPlayer, 'tackles ball', this.board.gameTime, this.ball.goalProximity)\n    this.ball.possess(winningPlayer.shockballPlayerUid)\n    this.ball.lastSideTouched = winningPlayer.homeGoalSide\n    this.ball.lastPlayerTouched = winningPlayer.shockballPlayerUid\n  }\n\n  resolvePlayerRun() {\n    // here the player THINKS he can ran, but in reality he'd have challengers.\n    // for now, he is unhindered\n    const theBall = this.ball\n    const runningPlayer = this.playerTryRun.find(function(player) {\n      return player.shockballPlayerUid === theBall.possessedBy\n    })\n\n    //first player needs to beat tackle challenges from opposition, if there are any\n    if (this.playerTryTackle.length > 0) {\n      //we'll pick one at random for now\n      const randomTackler = chance.pickone(this.playerTryTackle, 1)\n      const tacklerScore = randomTackler.toughness + randomTackler.vision + chance.rpg('2d6', {sum:true})\n      const runningPlayerScore = runningPlayer.toughness + runningPlayer.vision + chance.rpg('2d6', {sum:true})\n      if (runningPlayerScore > tacklerScore) {\n        this.runForward(runningPlayer)\n      } else {\n        //gets tackled\n        this.getsTackled(runningPlayer, randomTackler, theBall)\n      }\n    } else {\n      this.runForward(runningPlayer)\n    }\n\n  }\n\n  resolvePlayerTryScore() {\n    // here is where the player THINKS he can score so he TRIES, and it's where reality kicks in and other players are attempting to block/stop/intercept him.\n    // for now, there are no other players so he's free to proceed unhindered, will write logic for challenging later\n    const theBall = this.ball\n    const shootingPlayer = this.playerTryScore.find(function(player) {\n      return player.shockballPlayerUid === theBall.possessedBy\n    })\n\n    if (!shootingPlayer) {\n      // if there is no shooting player then it could be because the ballhandler didn't actually try to shoot (thus isn't in the array) but a player THOUGHT\n      // that he might based on their playerWorldModel understanding!  Basically he got it wrong.  :).  So we return out of this function altogether.\n      // if (this.pitch.state !== 'play_on') {\n      //   this.gameStateReset(theBall)\n      // }\n      return\n    }\n\n    const attackingSide = shootingPlayer.homeGoalSide === 'left' ? 'right' : 'left'\n    //this is the shot attempt, make a record\n    this.record.add(shootingPlayer, 'shoots', this.board.gameTime, theBall.goalProximity)\n    //we now need to calculate if he scored or missed/was blocked\n    // we do a blanket probability of 60/30/10 for blocking by Guard then Wing and then Center.\n    let probability = Math.random()\n    let opposingPlayer = undefined\n    if (probability < 0.4) {\n      // Guard tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryScore.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Guard'\n      })\n    } else if (probability < 0.6) {\n      // Wing tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryScore.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Wing'\n      })\n    } else {\n      // Center tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryScore.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Center'\n      })\n    }\n\n    //we handle here if generated bots by chance didn't have the right positions (I am not enforcing alwaysa  Guard, Wing, Center)\n    if (!opposingPlayer) {\n      //kinda hacky!\n      opposingPlayer = shootingPlayer\n    }\n\n    const shootingScore = shootingPlayer.throwing + shootingPlayer.vision + chance.rpg('2d6', {sum:true})\n    const blockingScore = opposingPlayer.blocking + opposingPlayer.vision + chance.rpg('2d6', {sum:true})\n\n    if (shootingScore > blockingScore || shootingPlayer === opposingPlayer) {\n      this.score(shootingPlayer, opposingPlayer, theBall)\n    } else {\n      // shooter is blocked\n      this.goalBlock(shootingPlayer, opposingPlayer, theBall)\n    }\n\n  }\n\n  resolvePlayerTryPass() {\n    // player THINKS he can pass so he tries.  We will need to transfer the ball possession to another player on success.\n    const theBall = this.ball\n    const leftPlayers = this.leftPlayers.slice()\n    const rightPlayers = this.rightPlayers.slice()\n\n    const passingPlayer = this.playerTryPass.find(function(player) {\n      return player.shockballPlayerUid === theBall.possessedBy\n    })\n\n    if (!passingPlayer) {\n      //we need to return because ball has been fumbled and noone possesses it\n      return\n    }\n\n    //TODO make much better determination here!\n    const attackingSide = passingPlayer.homeGoalSide === 'left' ? 'right' : 'left'\n    let probability = Math.random()\n    let opposingPlayer = undefined\n    if (probability < 0.4) {\n      // Guard tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryPass.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Guard'\n      })\n    } else if (probability < 0.6) {\n      // Wing tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryPass.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Wing'\n      })\n    } else {\n      // Center tries block action and if he fails, shooter is able to shoot\n      opposingPlayer = this.playerTryPass.find(function(player) {\n        return player.homeGoalSide === attackingSide && player.role === 'Center'\n      })\n    }\n\n    //we handle here if generated bots by chance didn't have the right positions (I am not enforcing always a Guard, Wing, Center)\n    if (!opposingPlayer) {\n      //kinda hacky!\n      opposingPlayer = passingPlayer\n    }\n\n    const passingScore = passingPlayer.passing + passingPlayer.vision + chance.rpg('2d6', {sum:true})\n    const blockingScore = opposingPlayer.blocking + opposingPlayer.vision + chance.rpg('2d6', {sum:true})\n\n    if (passingScore > blockingScore || passingPlayer === opposingPlayer) {\n      //pass will be successful, now choose what teammate to pass to\n      this.passForward(passingPlayer, theBall, leftPlayers, rightPlayers)\n    } else {\n      //passer is blocked\n      this.passBlock(opposingPlayer, theBall)\n    }\n  }\n\n  score(shootingPlayer, opposingPlayer, ball) {\n    shootingPlayer.opposingActorUid = opposingPlayer.shockballPlayerUid\n    shootingPlayer.opposingActorName = opposingPlayer.name\n    this.record.add(shootingPlayer, 'goal', this.board.gameTime, ball.goalProximity)\n    this.addToScoreBoard(shootingPlayer)\n    this.gameStateReset(ball)\n  }\n\n  gameStateReset(ball) {\n    ball.reset()\n    this.pitch.state = 'before_kickoff'\n    ball.lastSideTouched = null\n  }\n\n  addToScoreBoard(shootingPlayer) {\n    this.board.addScore(shootingPlayer.homeGoalSide)\n    this.pitch.lastGoalSide = shootingPlayer.homeGoalSide\n  }\n\n  goalBlock(shootingPlayer, opposingPlayer, ball) {\n    opposingPlayer.opposingActorUid = shootingPlayer.shockballPlayerUid\n    opposingPlayer.opposingActorName = shootingPlayer.name\n    this.record.add(opposingPlayer, 'goal blocked', this.board.gameTime, ball.goalProximity)\n    ball.possessedBy = opposingPlayer.shockballPlayerUid\n    ball.lastSideTouched = opposingPlayer.homeGoalSide\n  }\n\n  runForward(runningPlayer) {\n    if (Math.abs(this.ball.goalProximity) < Math.abs(this.pitch.goalPit[runningPlayer.homeGoalSide])) {\n      if (runningPlayer.homeGoalSide === 'right') {\n        this.record.add(runningPlayer, 'runs ball', this.board.gameTime, this.ball.goalProximity)\n        if (this.pitch.goalPit.left < this.ball.goalProximity) {\n          this.ball.goalProximity--\n        }\n      } else if (runningPlayer.homeGoalSide === 'left') {\n        this.record.add(runningPlayer, 'runs ball', this.board.gameTime, this.ball.goalProximity)\n        if (this.pitch.goalPit.right > this.ball.goalProximity) {\n          this.ball.goalProximity++\n        }\n      }\n    } else {\n      // console.error('in this player run else')\n    }\n  }\n\n  passForward(passingPlayer, ball, leftPlayers, rightPlayers) {\n    if (passingPlayer.homeGoalSide === 'right') {\n      const availableTeammates = rightPlayers.filter(function(player) {\n        return player.shockballPlayerUid !== passingPlayer.shockballPlayerUid\n      })\n      const playerToWinPossession = chance.pickone(availableTeammates, 1)\n      this.record.add(passingPlayer, 'passes ball', this.board.gameTime, ball.goalProximity)\n      if (this.pitch.goalPit.left < ball.goalProximity) {\n        ball.goalProximity--\n      }\n      ball.possessedBy = playerToWinPossession.shockballPlayerUid\n    } else {\n      const availableTeammates = leftPlayers.filter(function(player) {\n        return player.shockballPlayerUid !== passingPlayer.shockballPlayerUid\n      })\n      const playerToWinPossession = chance.pickone(availableTeammates, 1)\n      this.record.add(passingPlayer, 'passes ball', this.board.gameTime, ball.goalProximity)\n      if (this.pitch.goalPit.right > ball.goalProximity) {\n        ball.goalProximity++\n      }\n      ball.possessedBy = playerToWinPossession.shockballPlayerUid\n    }\n  }\n\n  passBlock(opposingPlayer, ball) {\n    this.record.add(opposingPlayer, 'pass blocked', this.board.gameTime, ball.goalProximity)\n    ball.lastSideTouched = opposingPlayer.homeGoalSide\n    ball.possessedBy = opposingPlayer.shockballPlayerUid\n  }\n\n  getsTackled(runningPlayer, randomTackler, ball) {\n    randomTackler.opposingActorUid = runningPlayer.shockballPlayerUid\n    randomTackler.opposingActorName = runningPlayer.name\n    this.record.add(randomTackler, 'tackles', this.board.gameTime, ball.goalProximity)\n    ball.possess(randomTackler.shockballPlayerUid)\n    ball.lastSideTouched = randomTackler.homeGoalSide\n    ball.lastPlayerTouched = randomTackler.shockballPlayerUid\n  }\n\n}"]}
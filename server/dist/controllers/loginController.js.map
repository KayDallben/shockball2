{"version":3,"sources":["../../src/controllers/loginController.js"],"names":["swcApi","LoginController","logger","req","res","validation","validate","query","listOneParams","error","getAccessToken","authorization_code","tokenInfo","status","send","data"],"mappings":";;;;;;qjBAAA;;;AAGA;;;AAFA;;;;AAGA;;IAAYA,M;;AACZ;;;;;;;;;;;;IAEMC,e;AAEJ,2BAAYC,MAAZ,EAAoB;AAAA;;AAClB,SAAKA,MAAL,GAAcA,MAAd;AACD;;;;;0FAEaC,G,EAAKC,G;;;;;;AACXC,0B,GAAa,cAAIC,QAAJ,CAAaH,IAAII,KAAjB,EAAwB,gBAAYC,aAApC,C;;sBACfH,WAAWI,KAAX,KAAqB,I;;;;;;;uBAEGT,OAAOU,cAAP,CAAsBP,IAAII,KAAJ,CAAUI,kBAAhC,C;;;AAAlBC,yB;;AACNR,oBAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBF,UAAUG,IAA/B;;;;;;;;AAEA,qBAAKb,MAAL,CAAYO,KAAZ;AACAL,oBAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,uCAArB;;;;;;;AAGF,qBAAKZ,MAAL,CAAYO,KAAZ,CAAkB,2BAA2BJ,WAAWI,KAAxD;AACAL,oBAAIS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBT,WAAWI,KAAhC;;;;;;;;;;;;;;;;;;;;;kBAMSR,e","file":"loginController.js","sourcesContent":["//third party\r\nimport Joi from 'joi'\r\n\r\n//internal\r\nimport * as swcApi from '../lib/swcApi'\r\nimport LoginSchema from '../models/Login.js'\r\n\r\nclass LoginController {\r\n\r\n  constructor(logger) {\r\n    this.logger = logger\r\n  }\r\n\r\n  async listOne(req, res) {\r\n    const validation = Joi.validate(req.query, LoginSchema.listOneParams)\r\n    if (validation.error === null) {\r\n      try {\r\n        const tokenInfo = await swcApi.getAccessToken(req.query.authorization_code)\r\n        res.status(200).send(tokenInfo.data)\r\n      } catch(error) {\r\n        this.logger.error(error)\r\n        res.status(400).send('Error creating new player in database')\r\n      }\r\n    } else {\r\n      this.logger.error('Joi validation error: ' + validation.error)\r\n      res.status(400).send(validation.error)\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default LoginController"]}